{"version":3,"sources":["sourceMap"],"names":["main","window","console","a","b","document","_","c","Map","d","o","p","q","r","s","Promise","t","Date","u","v","w","x","y","z","A","B","C","D","setTimeout","E","F","M","G","N","H","I","J","K","L","e","undefined","isNaN","parseInt","f","g","k","JSON","h","i","l","j","m","n","XMLHttpRequest"],"mappings":"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","sourcesContent":["// console.clear();\n\nfunction main() {\n\tif (window.COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING) {\n\t\tconsole.log('ERROR: bookmarklet is already running');\n\t\treturn; // https://stackoverflow.com/questions/550574/how-to-terminate-the-script-in-javascript\n\t}\n\twindow.COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING = true; // global scope var, https://stackoverflow.com/questions/9521298/verify-external-script-is-loaded\n\n\tconsole.log('bookmarklet called');\n\n\tvar url = 'https://dynatrace.timecockpit.com';\n\n\tif (window.location.origin !== url) {\n\t\tvar dummy = document.createElement('dummy');\n\t\tdummy.innerHTML = '\\\n\t\t\t<div style=\"position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: 999; background-color: rgba(0, 0, 0, 0.66); display: grid;\">\\\n\t\t\t\t<div style=\"margin: auto; padding: 24px; box-sizing: border-box; font-size: 24px; background-color: yellow; border-radius: 4px; font-family: Roboto, \\'Segoe UI\\', BlinkMacSystemFont, system-ui, -apple-system, Arial, Helvetica, sans-serif;\">\\\n\t\t\t\t\t...redirecting to ' + url + '. Run the bookmarklet again after the site loaded.\\\n\t\t\t\t</div>\\\n\t\t\t</div>';\n\t\tdocument.body.appendChild(dummy.querySelector('div')); // https://developer.mozilla.org/de/docs/Web/API/Document/body and https://stackoverflow.com/questions/9614932/best-way-to-create-large-static-dom-elements-in-javascript\n\n\t\twindow.setTimeout(function () {\n\t\t\t// https://stackoverflow.com/questions/18048338/how-can-i-execute-a-script-after-calling-window-location-href\n\t\t\t// window.onload = function () { ... cannot be performed after the redirect\n\t\t\twindow.location.href = url;\n\t\t}, 1000);\n\n\t} else {\n\t\tif (document.readyState && document.readyState === 'complete') {\n\t\t\t_.createContent();\n\t\t} else {\n\t\t\twindow.COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING = false;\n\t\t}\n\t}\n}\n\nvar _ = (function () { // https://gomakethings.com/creating-your-own-vanilla-js-helper-library-like-lodash-and-underscore.js/\n\t'use strict';\n\tvar methods = {};\n\n\t// caches\n\tvar cacheUserDetailUuid;\n\tvar cacheTaskIdAndProjectId = new Map();\n\n\tvar statusOfPreviousLineDone = 'done';\n\n\tmethods.createContent = function () {\n\t\tvar idCss = 'com_kamilsarelo_dynatrace_timetracking_css';\n\t\tvar idHtml = 'com_kamilsarelo_dynatrace_timetracking_html'; // https://stackoverflow.com/questions/6028211/what-is-the-standard-naming-convention-for-html-css-ids-and-classes/37797488#37797488\n\n\t\t// clear previous instances\n\t\tfunction clear() { // or:  var clear = function() {\n\t\t\t[idHtml, idCss].forEach(function (id) {\n\t\t\t\tdocument.querySelectorAll('#' + id).forEach(function (element) {\n\t\t\t\t\telement.parentNode.removeChild(element); //https://stackoverflow.com/questions/8830839/javascript-dom-remove-element/8830882\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\tclear();\n\n\t\t(function () { // or: function loadCss() { | var loadCss = function() {\n\t\t\treturn new Promise(function (resolve, reject) { // https://stackoverflow.com/questions/574944/how-to-load-up-css-files-using-javascript/51183077#51183077\n\n\t\t\t\t// CSS\n\n\t\t\t\tvar link = document.createElement('link');\n\t\t\t\tlink.id = idCss;\n\t\t\t\tlink.rel = 'stylesheet';\n\t\t\t\tlink.type = 'text/css';\n\t\t\t\t// link.href = 'https://localhost/bookmarklet.css';\n\t\t\t\t// link.href = 'https://cdn.jsdelivr.net/gh/kamilsarelo/timetracking/bookmarklet/bookmarklet.css';\n\t\t\t\tlink.href = 'https://christian-fischer.github.io/com.dynatrace.timetracking.bookmarklet.css?q=' + (new Date).getTime();\n\t\t\t\tlink.media = 'all';\n\t\t\t\tlink.onload = function () { // https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onload and https://stackoverflow.com/questions/6348494/addeventlistener-vs-onclick/6348533#6348533\n\t\t\t\t\tresolve();\n\t\t\t\t};\n\t\t\t\tdocument.head.appendChild(link); // https://developer.mozilla.org/de/docs/Web/API/Document/head\n\t\t\t});\n\t\t})() // anonymous function call: https://stackoverflow.com/questions/7498361/defining-and-calling-function-in-one-step\n\t\t\t.then(function () { // or: // loadCss().then(function () {\n\n\t\t\t\t// HTML\n\n\t\t\t\tvar idContent = 'com_kamilsarelo_dynatrace_timetracking_content';\n\t\t\t\tvar idHeader = 'com_kamilsarelo_dynatrace_timetracking_header';\n\t\t\t\tvar idMain = 'com_kamilsarelo_dynatrace_timetracking_main';\n\t\t\t\tvar idInput = 'com_kamilsarelo_dynatrace_timetracking_input';\n\t\t\t\tvar idFooter = 'com_kamilsarelo_dynatrace_timetracking_footer';\n\t\t\t\tvar idFooterLeft = 'com_kamilsarelo_dynatrace_timetracking_footer_left';\n\t\t\t\tvar idFooterRight = 'com_kamilsarelo_dynatrace_timetracking_footer_right';\n\t\t\t\tvar idSelectType = 'com_kamilsarelo_dynatrace_timetracking_select_type';\n\t\t\t\tvar idButtonBook = 'com_kamilsarelo_dynatrace_timetracking_action_book';\n\t\t\t\tvar idButtonClear = 'com_kamilsarelo_dynatrace_timetracking_action_clear';\n\t\t\t\tvar idButtonClose = 'com_kamilsarelo_dynatrace_timetracking_action_close';\n\t\t\t\tvar idLoader = 'com_kamilsarelo_dynatrace_timetracking_loader';\n\n\t\t\t\tvar dummy = document.createElement('dummy');\n\t\t\t\tdummy.innerHTML = '\\\n\t\t\t\t\t<div id=\"' + idHtml + '\">\\\n\t\t\t\t\t\t<div id=\"' + idContent + '\">\\\n\t\t\t\t\t\t\t<div id=\"' + idHeader + '\">\\\n\t\t\t\t\t\t\t\t<select id=\"' + idSelectType + '\" class=\"filament-select-css\">\\\n\t\t\t\t\t\t\t\t\t<option value=\"cd4f750b-85f8-41f8-b193-9c82e23f82eb\" selected=\"selected\">Office</option>\\\n\t\t\t\t\t\t\t\t\t<option value=\"0ad94cf7-955c-45dc-b49e-20be0f449b75\">Home Office</option>\\\n\t\t\t\t\t\t\t\t</select>\\\n\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t<div id=\"' + idMain + '\">\\\n\t\t\t\t\t\t\t\t<div id=\"' + idInput + '\" contenteditable=\"true\">\\\n\t\t\t\t\t\t\t\t\t&#xfeff;\\\n\t\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t\t<div id=\"' + idLoader + '\">\\\n\t\t\t\t\t\t\t\t\t<div class=\"spin-wrapper\">\\\n\t\t\t\t\t\t\t\t\t\t<div class=\"spinner\">\\\n\t\t\t\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t<div id=\"' + idFooter + '\">\\\n\t\t\t\t\t\t\t\t<button id=\"' + idButtonBook + '\" class=\"pure-material-button-contained\">Book</button>\\\n\t\t\t\t\t\t\t\t<button id=\"' + idButtonClear + '\" class=\"pure-material-button-outlined\">Clear</button>\\\n\t\t\t\t\t\t\t\t<button id=\"' + idButtonClose + '\" class=\"pure-material-button-outlined\">Close</button>\\\n\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t</div>\\\n\t\t\t\t\t</div>';\n\t\t\t\tdocument.body.appendChild(dummy.querySelector('div'));\n\n\t\t\t\tsetTimeout(function () { // must be deferred, https://stackoverflow.com/questions/18509507/why-use-settimeout-in-deferred\n\t\t\t\t\tdocument.getElementById(idInput).focus();\n\t\t\t\t}, 0);\n\n\t\t\t\t// document.getElementById(idInput).addEventListener('paste', function (e) { // https://stackoverflow.com/questions/21257688/paste-rich-text-into-content-editable-div-and-only-keep-bold-and-italics-formatt\n\t\t\t\t// \te.preventDefault();\n\t\t\t\t// \tvar clipboardData = e.clipboardData;\n\t\t\t\t// \tvar dataText = clipboardData.getData('text/plain');\n\t\t\t\t// \tif (dataText && dataText.trim().length != 0) {\n\t\t\t\t// \t\tdocument.getElementById(idInput).innerText = dataText;\n\t\t\t\t// \t\treturn false; // prevent returning text in clipboard\n\t\t\t\t// \t}\n\t\t\t\t// }, false);\n\t\t\t\t//\n\t\t\t\t// ...this is good, but the following is better...\n\t\t\t\t//\n\t\t\t\tdocument.getElementById(idInput).addEventListener('paste', function (e) { // https://stackoverflow.com/questions/12027137/javascript-trick-for-paste-as-plain-text-in-execcommand/19327995#19327995\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar content = (e.originalEvent || e).clipboardData.getData('text/plain');\n\t\t\t\t\tdocument.execCommand('insertText', false, content);\n\t\t\t\t});\n\n\t\t\t\tdocument.getElementById(idButtonBook)\n\t\t\t\t\t.onclick = function () {\n\t\t\t\t\t\tvar input = document.getElementById(idInput);\n\n\t\t\t\t\t\t// remove all html except line breaks\n\t\t\t\t\t\tinput.querySelectorAll('*:not(br)').forEach(function (span) { // also: ... .forEach(span => { ...\n\t\t\t\t\t\t\tinput.removeChild(span);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tvar string = input.innerText; // or https://developer.mozilla.org/de/docs/Web/API/Node/textContent but textContent ignores line breaks\n\t\t\t\t\t\tif (string.trim().length === 0) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfunction setEnabled(isEnabled) {\n\t\t\t\t\t\t\t[idButtonBook, idButtonClear, idButtonClose].forEach(function (id) {\n\t\t\t\t\t\t\t\tdocument.getElementById(id).disabled = !isEnabled;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tinput.contentEditable = isEnabled;\n\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\tdocument.getElementById(idLoader).style.visibility = isEnabled ? 'hidden' : 'visible';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetEnabled(false);\n\n\t\t\t\t\t\tvar selectType = document.getElementById(idSelectType);\n\t\t\t\t\t\tvar timesheetTypeUuid = selectType.options[selectType.selectedIndex].value;\n\n\t\t\t\t\t\tinput.innerHTML = '';\n\t\t\t\t\t\tvar linePrevious;\n\n\t\t\t\t\t\tvar lineArray = string.split(/\\r\\n|\\r|\\n/g); // also string.split(/\\r?\\n/g); but mind: https://stackoverflow.com/questions/21711768/split-string-in-javascript-and-detect-line-break/21712066#21712066\n\t\t\t\t\t\t// lineArray.forEach(function (line) { ...\n\t\t\t\t\t\t// the whole booking process has to be done sequential via synchronous xhr (xhr is parallel/async by default),\n\t\t\t\t\t\t// so caches can work, AND most importantly no duplicate entities are created\n\t\t\t\t\t\t// but synchronous xhr should be used in workers exclusively: https://xhr.spec.whatwg.org/#synchronous-flag\n\t\t\t\t\t\t// ...thus forEach cannot be used\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// \"Synchronous XMLHttpRequest outside of workers is in the process of being removed from the web platform\n\t\t\t\t\t\t// as it has detrimental effects to the end userâ€™s experience. (This is a long process that takes many years.)\n\t\t\t\t\t\t// Developers must not pass false for the async argument when current global object is a Window object.\n\t\t\t\t\t\t// User agents are strongly encouraged to warn about such usage in developer tools\n\t\t\t\t\t\t// and may experiment with throwing an \"InvalidAccessError\" DOMException when it occurs.\"\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// ...thus let's simulate synchronours xhr with a mutex callback... https://www.mkyong.com/java/java-thread-mutex-and-semaphore-example/\n\t\t\t\t\t\tvar synchronizedLineProcessor = function (statusOfPreviousLine) {\n\t\t\t\t\t\t\tif (linePrevious) {\n\t\t\t\t\t\t\t\tinput.innerHTML =\n\t\t\t\t\t\t\t\t\t(input.innerHTML\n\t\t\t\t\t\t\t\t\t\t? input.innerHTML + '<br>'\n\t\t\t\t\t\t\t\t\t\t: '')\n\t\t\t\t\t\t\t\t\t+ (statusOfPreviousLine\n\t\t\t\t\t\t\t\t\t\t? '<span class=\"pill\" style=\"background-color: ' + (statusOfPreviousLine === statusOfPreviousLineDone ? 'green' : 'red') + ';\">' + statusOfPreviousLine + '</span>'\n\t\t\t\t\t\t\t\t\t\t: '')\n\t\t\t\t\t\t\t\t\t+ linePrevious;\n\t\t\t\t\t\t\t\tinput.scrollTop = input.scrollHeight; // https://stackoverflow.com/questions/40495860/how-to-scroll-to-automatically-scroll-to-the-bottom-of-an-editable-div-onload/40506676#40506676\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (lineArray.length > 0) {\n\t\t\t\t\t\t\t\tlinePrevious = lineArray.shift(); // https://love2dev.com/blog/javascript-remove-from-array/\n\t\t\t\t\t\t\t\tcheckLineAndParseProperties(linePrevious, timesheetTypeUuid, synchronizedLineProcessor); // first step, forwards to consecutive steps\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetEnabled(true);\n\t\t\t\t\t\t\t\tvar refreshButton = document.querySelector('button\\[ng-click=\"refresh\\(\\)\"\\]');\n\t\t\t\t\t\t\t\tif (refreshButton) {\n\t\t\t\t\t\t\t\t\trefreshButton.click();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTimeout(function () { // must be deferred\n\t\t\t\t\t\t\tsynchronizedLineProcessor();\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t};\n\n\t\t\t\tdocument.getElementById(idButtonClear)\n\t\t\t\t\t.onclick = function () { // https://stackoverflow.com/questions/6348494/addeventlistener-vs-onclick\n\t\t\t\t\t\tvar input = document.getElementById(idInput);\n\t\t\t\t\t\tinput.innerHTML = ''; // https://stackoverflow.com/questions/3450593/how-do-i-clear-the-content-of-a-div-using-javascript\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t};\n\n\t\t\t\tdocument.getElementById(idButtonClose)\n\t\t\t\t\t.onclick = function () {\n\t\t\t\t\t\tclear();\n\t\t\t\t\t};\n\n\t\t\t\tdocument.onkeydown = function (event) {\n\t\t\t\t\tevent = event || window.event;\n\t\t\t\t\tif (event.keyCode == 27) { // ESC key\n\t\t\t\t\t\tclear();\n\t\t\t\t\t\tdocument.onkeydown = undefined; // deregister\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\twindow.COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING = false;\n\t\t\t});\n\t};\n\n\tfunction checkLineAndParseProperties(line, timesheetTypeUuid, callback) {\n\t\tline = line.trim();\n\t\tif (!line) {\n\t\t\tcallback(); // no error on empty line\n\t\t\treturn;\n\t\t}\n\n\t\tvar properties = (function () { //anonymous function in order to use \"return\" and no need to deferred call of callback before each return\n\t\t\t// basic sanity checks:\n\t\t\t// 2019-03-11|12:00|16:00|...|...\n\t\t\t// 0123456789 123456789 123456789\n\t\t\tif (!line // not: null undefined NaN \"\" 0 false: https://stackoverflow.com/questions/5515310/is-there-a-standard-function-to-check-for-null-undefined-or-blank-variables-in/5515349#5515349\n\t\t\t\t|| line.length <= 23 // first 23 characters are fixed width: date, time, time\n\t\t\t\t|| isNaN(line.charAt(0)) // first character must be a number: https://stackoverflow.com/questions/8935632/check-if-character-is-number\n\t\t\t\t|| '|' !== line.charAt(10)\n\t\t\t\t|| '|' !== line.charAt(16)\n\t\t\t\t|| '|' !== line.charAt(22)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// date and times\n\t\t\tvar stringDate = line.substr(0, 10); // https://www.w3schools.com/jsref/jsref_obj_string.asp\n\t\t\tvar stringTimeBegin = line.substr(11, 5);\n\t\t\tvar stringTimeEnd = line.substr(17, 5);\n\t\t\t// Jira key\n\t\t\tvar indexOfPipe = line.indexOf('|', 23);\n\t\t\tif (indexOfPipe === -1) { // no delimiter after Jira key\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar stringJiraKey = line.substring(23, indexOfPipe); // https://stackoverflow.com/questions/2243824/what-is-the-difference-between-string-slice-and-string-substring\n\t\t\tif (stringJiraKey === '') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// comment\n\t\t\tvar stringComment = line.substr(indexOfPipe + 1);\n\t\t\tif (stringComment === '') { // empty comment\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t{ // date sanity checks\n\t\t\t\t// valid delimiters\n\t\t\t\tif ('-' !== stringDate.charAt(4) || '-' !== stringDate.charAt(7)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid digits: https://stackoverflow.com/questions/175739/built-in-way-in-javascript-to-check-if-a-string-is-a-valid-number\n\t\t\t\tif (isNaN(stringDate.charAt(0)) || isNaN(stringDate.charAt(1)) || isNaN(stringDate.charAt(2)) || isNaN(stringDate.charAt(3))\n\t\t\t\t\t|| isNaN(stringDate.charAt(5)) || isNaN(stringDate.charAt(6))\n\t\t\t\t\t|| isNaN(stringDate.charAt(8)) || isNaN(stringDate.charAt(9))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid year\n\t\t\t\tvar integerYearCurrent = new Date().getFullYear();\n\t\t\t\tvar integerYear = parseInt(stringDate.substr(0, 4), 10);\n\t\t\t\t// if (isNaN(integerYear) || integerYear < 2019 || integerYear > 2046) {\n\t\t\t\tif (isNaN(integerYear) || integerYear < integerYearCurrent || integerYear > integerYearCurrent) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid month\n\t\t\t\tvar integerMonth = parseInt(stringDate.substr(5, 2), 10);\n\t\t\t\tif (isNaN(integerYear) || integerMonth < 1 || integerMonth > 12) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid day\n\t\t\t\tvar integerDay = parseInt(stringDate.substr(8, 2), 10);\n\t\t\t\tif (isNaN(integerYear) || integerDay < 1 || integerDay > 31) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid date\n\t\t\t\tif ((function () {\n\t\t\t\t\tvar date = new Date();\n\t\t\t\t\tdate.setFullYear(integerYear, integerMonth - 1, integerDay);\n\t\t\t\t\treturn date.getFullYear() !== integerYear || date.getMonth() !== integerMonth - 1 || date.getDate() !== integerDay; // https://ctrlq.org/code/20109-javascript-date-valid\n\t\t\t\t})()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t{ // time sanity checks\n\t\t\t\tfunction isInvaliDigit(stringTime) {\n\t\t\t\t\treturn isNaN(stringTime.charAt(0)) || isNaN(stringTime.charAt(1)) || isNaN(stringTime.charAt(3)) || isNaN(stringTime.charAt(4));\n\t\t\t\t}\n\t\t\t\tfunction isInvalidHour(integerHour) {\n\t\t\t\t\treturn isNaN(integerHour) || integerHour < 0 || integerHour > 23;\n\t\t\t\t}\n\t\t\t\tfunction isInvalidMinute(integerMinute) {\n\t\t\t\t\treturn isNaN(integerMinute) || integerMinute < 0 || integerMinute > 59;\n\t\t\t\t}\n\t\t\t\t// valid delimiters\n\t\t\t\tif (':' !== stringTimeBegin.charAt(2) || ':' !== stringTimeEnd.charAt(2)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid digits\n\t\t\t\tif (isInvaliDigit(stringTimeBegin) || isInvaliDigit(stringTimeEnd)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid hours\n\t\t\t\tvar integerHourBegin = parseInt(stringTimeBegin.substr(0, 2), 10);\n\t\t\t\tvar integerHourEnd = parseInt(stringTimeEnd.substr(0, 2), 10);\n\t\t\t\tif (isInvalidHour(integerHourBegin) || isInvalidHour(integerHourEnd)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// valid minutes\n\t\t\t\tvar integerMinuteBegin = parseInt(stringTimeBegin.substr(3, 2), 10);\n\t\t\t\tvar integerMinuteEnd = parseInt(stringTimeEnd.substr(3, 2), 10);\n\t\t\t\tif (isInvalidMinute(integerMinuteBegin) || isInvalidMinute(integerMinuteEnd)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// begin actually before end\n\t\t\t\tif (integerHourBegin > integerHourEnd\n\t\t\t\t\t|| integerHourBegin === integerHourEnd && integerMinuteBegin >= integerMinuteEnd) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar APP_BeginTime = stringDate + 'T' + stringTimeBegin + ':00';\n\t\t\tvar APP_EndTime = stringDate + 'T' + stringTimeEnd + ':00';\n\t\t\t// var APP_Description = encodeURIComponent(stringComment); // encoding not necessary, https://stackoverflow.com/questions/332872/encode-url-in-javascript/6171234#6171234\n\t\t\tvar APP_Description = stringComment;\n\n\t\t\treturn { // https://stackoverflow.com/questions/12272239/javascript-function-returning-an-object\n\t\t\t\tjiraKey: stringJiraKey,\n\t\t\t\tAPP_BeginTime: APP_BeginTime,\n\t\t\t\tAPP_EndTime: APP_EndTime,\n\t\t\t\tAPP_Description: APP_Description\n\t\t\t};\n\t\t})();\n\t\tif (properties) {\n\t\t\tproperties.USR_TimesheetTypeUuid = timesheetTypeUuid;\n\n\t\t\t// console.log('properties');\n\t\t\t// console.log('  jiraKey               = ' + properties.jiraKey);\n\t\t\t// console.log('  APP_BeginTime         = ' + properties.APP_BeginTime);\n\t\t\t// console.log('  APP_EndTime           = ' + properties.APP_EndTime);\n\t\t\t// console.log('  APP_Description       = ' + properties.APP_Description);\n\t\t\t// console.log('  USR_TimesheetTypeUuid = ' + properties.USR_TimesheetTypeUuid);\n\n\t\t\tqueryUserId(properties, callback);\n\t\t} else {\n\t\t\tcallback('invalid');\n\t\t}\n\t};\n\n\tfunction queryUserId(properties, callback) {\n\t\tfunction nextStep() {\n\t\t\tproperties.APP_UserDetailUuid = cacheUserDetailUuid;\n\t\t\t// console.log('APP_UserDetailUuid = ' + properties.APP_UserDetailUuid);\n\t\t\t\n\t\t\tcheckIfEntityWithEqualBeginOrEndTimeAlreadyExists(properties, callback);\n\t\t}\n\t\tif (cacheUserDetailUuid) {\n\t\t\tnextStep(); // not deferred, because async xhr starts immediately in next step\n\t\t\treturn; // avoid running callback too early\n\t\t}\n\t\txhrGet('/shell/user')\n\t\t\t.then(function (response) {\n\t\t\t\t// console.log(response);\n\t\t\t\tvar json = JSON.parse(response);\n\t\t\t\tif (json) {\n\t\t\t\t\tif (json.useruuid) {\n\t\t\t\t\t\tcacheUserDetailUuid = json.useruuid;\n\t\t\t\t\t\tnextStep();\n\t\t\t\t\t\treturn; // avoid running callback too early\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('ERROR: no useruuid available');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('ERROR: on JSON.parse() in queryUserId()');\n\t\t\t\t}\n\t\t\t\tcallback('error');\n\t\t\t})\n\t\t\t.catch(function (error) {\n\t\t\t\tconsole.log('ERROR: in queryUserId()', error);\n\t\t\t\tcallback(error.status || 'error');\n\t\t\t});\n\t\t;\n\t}\n\n\tfunction checkIfEntityWithEqualBeginOrEndTimeAlreadyExists(properties, callback) {\n\t\txhrGet('/odata/APP_Timesheet'\n\t\t\t+ '?$filter=(APP_BeginTime eq datetime\\'' + properties.APP_BeginTime + '\\''\n\t\t\t+ ' or APP_EndTime eq datetime\\'' + properties.APP_EndTime + '\\')'\n\t\t\t+ ' and APP_UserDetailUuid eq guid\\'' + properties.APP_UserDetailUuid + '\\'')\n\t\t\t.then(function (response) {\n\t\t\t\t// console.log(response);\n\t\t\t\tvar json = JSON.parse(response);\n\t\t\t\tif (json && json.value) {\n\t\t\t\t\tif (json.value.length > 0) {\n\t\t\t\t\t\tconsole.log('ERROR: APP_Timesheet entity with equal start- (' + properties.APP_BeginTime + ') and/or end-time (' + properties.APP_EndTime + ') exists');\n\t\t\t\t\t\tcallback('exists');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tqueryTaskIdAndProjectIdForJiraKey(properties, callback);\n\t\t\t\t\t\treturn; // avoid running callback too early\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('ERROR: on JSON.parse() in checkIfEntityWithEqualBeginOrEndTimeAlreadyExists()');\n\t\t\t\t}\n\t\t\t\tcallback('error');\n\t\t\t})\n\t\t\t.catch(function (error) {\n\t\t\t\tconsole.log('ERROR: in checkIfEntityWithEqualBeginOrEndTimeAlreadyExists()', error);\n\t\t\t\tcallback(error.status || 'error');\n\t\t\t})\n\t}\n\n\tfunction queryTaskIdAndProjectIdForJiraKey(properties, callback) {\n\t\tfunction nextStep() {\n\t\t\tvar cache = cacheTaskIdAndProjectId.get(properties.jiraKey);\n\t\t\tproperties.APP_TaskUuid = cache.APP_TaskUuid;\n\t\t\tproperties.APP_ProjectUuid = cache.APP_ProjectUuid;\n\n\t\t\t// console.log('  APP_TaskUuid          = ' + properties.APP_TaskUuid);\n\t\t\t// console.log('  APP_ProjectUuid       = ' + properties.APP_ProjectUuid);\n\n\t\t\tcreateEntity(properties, callback);\n\t\t}\n\t\tif (cacheTaskIdAndProjectId.has(properties.jiraKey)) {\n\t\t\tnextStep(); // not deferred, because async xhr starts immediately in next step\n\t\t\treturn; // avoid running callback too early\n\t\t}\n\t\txhrGet('/odata/APP_Task'\n\t\t\t+ '?$filter=APP_Code eq \\'' + properties.jiraKey + '\\''\n\t\t\t+ '&$select=APP_TaskUuid,APP_ProjectUuid')\n\t\t\t.then(function (response) {\n\t\t\t\tvar json = JSON.parse(response); // https://stackoverflow.com/questions/33169315/json-parse-selecting-from-a-select-container\n\t\t\t\tif (json && json.value) {\n\t\t\t\t\tif (json.value.length > 0) {\n\t\t\t\t\t\tcacheTaskIdAndProjectId.set(properties.jiraKey, {\n\t\t\t\t\t\t\tAPP_TaskUuid: json.value[0].APP_TaskUuid,\n\t\t\t\t\t\t\tAPP_ProjectUuid: json.value[0].APP_ProjectUuid\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnextStep();\n\t\t\t\t\t\treturn; // avoid running callback too early\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('ERROR: no APP_Task entity for specified Jira key (' + properties.jiraKey + ') available');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('ERROR: on JSON.parse() in queryTaskIdAndProjectIdForJiraKey()');\n\t\t\t\t}\n\t\t\t\tcallback('error');\n\t\t\t})\n\t\t\t.catch(function (error) {\n\t\t\t\tconsole.log('ERROR: in queryTaskIdAndProjectIdForJiraKey()', error);\n\t\t\t\tcallback(error.status || 'error');\n\t\t\t});\n\t}\n\n\tfunction createEntity(properties, callback) {\n\t\tvar json = JSON.stringify({\n\t\t\t// 'APP_TimesheetUuid': https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript/2117523#2117523\n\t\t\t'APP_BeginTime': properties.APP_BeginTime,\n\t\t\t'APP_EndTime': properties.APP_EndTime,\n\t\t\t'APP_Description': properties.APP_Description,\n\t\t\t'APP_TaskUuid': properties.APP_TaskUuid,\n\t\t\t'APP_ProjectUuid': properties.APP_ProjectUuid,\n\t\t\t'APP_UserDetailUuid': properties.APP_UserDetailUuid,\n\t\t\t'USR_TimesheetTypeUuid': properties.USR_TimesheetTypeUuid,\n\t\t\t// 'APP_IsDurationTimesheet': false,\n\t\t\t// 'APP_NoBilling': false,\n\t\t\t// 'USR_MedicalConfirmationReceived': false\n\t\t});\n\t\txhrPost('/odata/APP_Timesheet', json)\n\t\t\t.then(function (response) {\n\t\t\t\t// console.log('booked');\n\t\t\t\tcallback(statusOfPreviousLineDone);\n\t\t\t})\n\t\t\t.catch(function (error) {\n\t\t\t\tconsole.log('ERROR: in createEntity()', error);\n\t\t\t\tcallback(error.status || 'error');\n\t\t\t})\n\t}\n\n\tfunction deleteEntity(APP_TimesheetUuid) {\n\t\txhrDelete('/odata/APP_Timesheet(guid\\'' + APP_TimesheetUuid + '\\')')\n\t\t\t.then(function (response) {\n\t\t\t\tconsole.log('deleted APP_Timesheet entity with UUID: ' + APP_TimesheetUuid);\n\t\t\t})\n\t\t\t.catch(function (error) {\n\t\t\t\tconsole.log('ERROR: in deleteEntity()', error);\n\t\t\t});\n\n\t}\n\n\tfunction xhrGet(url) {\n\t\treturn xhr(url);\n\t};\n\n\tfunction xhrPost(url, json) {\n\t\treturn xhr(url, 'POST', json);\n\t};\n\n\tfunction xhrDelete(url) {\n\t\treturn xhr(url, 'DELETE');\n\t};\n\n\tfunction xhr(url, method, json) {\n\t\tvar request = new XMLHttpRequest();\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\trequest.onreadystatechange = function () {\n\t\t\t\tif (request.readyState !== 4) return; // 4 is DONE, https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\n\t\t\t\tif (request.status >= 200 && request.status < 300) {\n\t\t\t\t\t// console.dir(request);\n\t\t\t\t\t// console.log(response);\n\t\t\t\t\t// resolve(request);\n\t\t\t\t\tresolve(request.responseText);\n\t\t\t\t} else {\n\t\t\t\t\treject({\n\t\t\t\t\t\tstatus: request.status,\n\t\t\t\t\t\tstatusText: request.statusText\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t\trequest.open(method || 'GET', url, true);\n\t\t\trequest.setRequestHeader('cache-control', 'no-cache'); // https://stackoverflow.com/a/48969579\n\t\t\trequest.setRequestHeader('cache-control', 'max-age=0');\n\t\t\trequest.setRequestHeader('pragma', 'no-cache');\n\t\t\tif (method === 'POST') { // if (json) {\n\t\t\t\trequest.setRequestHeader(\"Content-Type\", \"application/json; charset=utf-8\");\n\t\t\t\trequest.send(json);\n\t\t\t} else {\n\t\t\t\trequest.send();\n\t\t\t}\n\t\t});\n\t};\n\n\treturn methods;\n})();\n\nmain();"]}