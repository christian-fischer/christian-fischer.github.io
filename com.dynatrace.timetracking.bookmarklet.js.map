{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./bookmarklet/bookmarklet.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","idCss","idHtml","idInput","idSelectType","idButtonBook","idButtonClear","idButtonClose","idLoader","cacheTaskIdAndProjectId","Map","cacheUserDetailUuid","isInvalidDigit","stringTime","isNaN","charAt","isInvalidHour","integerHour","isInvalidMinute","integerMinute","clear","forEach","id","document","querySelectorAll","element","parentNode","removeChild","createContent","Promise","resolve","link","createElement","rel","type","href","Date","now","media","onload","head","appendChild","then","dummy","innerHTML","body","querySelector","setTimeout","getElementById","focus","addEventListener","e","preventDefault","content","originalEvent","clipboardData","getData","execCommand","onclick","input","span","string","innerText","trim","length","setEnabled","isEnabled","disabled","contentEditable","style","visibility","selectType","timesheetTypeUuid","options","selectedIndex","linePrevious","lineArray","split","synchronizedLineProcessor","statusOfPreviousLine","scrollTop","scrollHeight","shift","line","callback","properties","stringDate","substr","stringTimeBegin","stringTimeEnd","indexOfPipe","indexOf","stringJiraKey","substring","stringComment","integerYearCurrent","getFullYear","integerYear","parseInt","integerMonth","integerDay","date","setFullYear","getMonth","getDate","integerHourBegin","integerHourEnd","integerMinuteBegin","integerMinuteEnd","jiraKey","APP_BeginTime","APP_EndTime","APP_Description","computeProperties","undefined","USR_TimesheetTypeUuid","nextStep","APP_UserDetailUuid","xhrGet","response","json","JSON","parse","console","log","cache","APP_TaskUuid","APP_ProjectUuid","url","xhr","xhrPost","stringify","catch","error","status","createEntity","has","set","queryTaskIdAndProjectIdForJiraKey","checkIfEntityWithEqualBeginOrEndTimeAlreadyExists","useruuid","queryUserId","checkLineAndParseProperties","refreshButton","click","onkeydown","event","window","keyCode","method","request","XMLHttpRequest","reject","onreadystatechange","readyState","responseText","statusText","open","setRequestHeader","send","location","origin"],"mappings":"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","file":"com.dynatrace.timetracking.bookmarklet.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import './bookmarklet.css';\n\nconst idCss = 'com_kamilsarelo_dynatrace_timetracking_css';\nconst idHtml = 'com_kamilsarelo_dynatrace_timetracking_html'; // https://stackoverflow.com/questions/6028211/what-is-the-standard-naming-convention-for-html-css-ids-and-classes/37797488#37797488\nconst idContent = 'com_kamilsarelo_dynatrace_timetracking_content';\nconst idHeader = 'com_kamilsarelo_dynatrace_timetracking_header';\nconst idMain = 'com_kamilsarelo_dynatrace_timetracking_main';\nconst idInput = 'com_kamilsarelo_dynatrace_timetracking_input';\nconst idFooter = 'com_kamilsarelo_dynatrace_timetracking_footer';\nconst idFooterLeft = 'com_kamilsarelo_dynatrace_timetracking_footer_left';\nconst idFooterRight = 'com_kamilsarelo_dynatrace_timetracking_footer_right';\nconst idSelectType = 'com_kamilsarelo_dynatrace_timetracking_select_type';\nconst idButtonBook = 'com_kamilsarelo_dynatrace_timetracking_action_book';\nconst idButtonClear = 'com_kamilsarelo_dynatrace_timetracking_action_clear';\nconst idButtonClose = 'com_kamilsarelo_dynatrace_timetracking_action_close';\nconst idLoader = 'com_kamilsarelo_dynatrace_timetracking_loader';\n\n// caches\nconst cacheTaskIdAndProjectId = new Map();\nconst statusOfPreviousLineDone = 'done';\n\nlet cacheUserDetailUuid;\n\ninterface TimecockpitEntryProperties {\n  jiraKey: string;\n\n  APP_BeginTime: string;\n  APP_EndTime: string;\n  APP_Description: string;\n  APP_TaskUuid?: string;\n  APP_ProjectUuid?: string;\n  APP_UserDetailUuid?: string;\n  USR_TimesheetTypeUuid?: string;\n\n  APP_IsDurationTimesheet?: boolean;\n  APP_NoBilling?: boolean;\n  USR_MedicalConfirmationReceived?: boolean;\n}\n\n// time sanity checks\nfunction isInvalidDigit(stringTime: string): boolean {\n  return (\n    isNaN(+stringTime.charAt(0)) ||\n    isNaN(+stringTime.charAt(1)) ||\n    isNaN(+stringTime.charAt(3)) ||\n    isNaN(+stringTime.charAt(4))\n  );\n}\n\nfunction isInvalidHour(integerHour: number): boolean {\n  return isNaN(integerHour) || integerHour < 0 || integerHour > 23;\n}\n\nfunction isInvalidMinute(integerMinute: number): boolean {\n  return isNaN(integerMinute) || integerMinute < 0 || integerMinute > 59;\n}\n\n// clear previous instances\nfunction clear(): void {\n  // or:  const clear = function() {\n  [idHtml, idCss].forEach((id) => {\n    document.querySelectorAll('#' + id).forEach((element) => {\n      element.parentNode.removeChild(element); //https://stackoverflow.com/questions/8830839/javascript-dom-remove-element/8830882\n    });\n  });\n}\n\nfunction createContent() {\n  clear();\n\n  // or: function loadCss() { | const loadCss = function() {\n  new Promise((resolve) => {\n    // https://stackoverflow.com/questions/574944/how-to-load-up-css-files-using-javascript/51183077#51183077\n\n    // CSS\n    const link = document.createElement('link');\n    link.id = idCss;\n    link.rel = 'stylesheet';\n    link.type = 'text/css';\n    // link.href = 'https://localhost/bookmarklet.css';\n    // link.href = 'https://cdn.jsdelivr.net/gh/kamilsarelo/timetracking/bookmarklet/bookmarklet.css';\n    link.href = `https://christian-fischer.github.io/com.dynatrace.timetracking.bookmarklet.css?q=${Date.now()}`;\n    link.media = 'all';\n    link.onload = () => {\n      // https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onload and https://stackoverflow.com/questions/6348494/addeventlistener-vs-onclick/6348533#6348533\n      resolve();\n    };\n    document.head.appendChild(link); // https://developer.mozilla.org/de/docs/Web/API/Document/head\n  }).then(() => {\n    // or: // loadCss().then(() => {\n\n    // HTML\n    const dummy = document.createElement('dummy');\n    dummy.innerHTML = `\n\t\t\t\t\t<div id=\"${idHtml}\">\n\t\t\t\t\t\t<div id=\"${idContent}\">\n\t\t\t\t\t\t\t<div id=\"${idHeader}\">\n\t\t\t\t\t\t\t\t<select id=\"${idSelectType}\" class=\"filament-select-css\">\n\t\t\t\t\t\t\t\t\t<option value=\"cd4f750b-85f8-41f8-b193-9c82e23f82eb\" selected=\"selected\">Office</option>\n\t\t\t\t\t\t\t\t\t<option value=\"0ad94cf7-955c-45dc-b49e-20be0f449b75\">Home Office</option>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div id=\"${idMain}\">\n\t\t\t\t\t\t\t\t<div id=\"${idInput}\" contenteditable=\"true\">\n\t\t\t\t\t\t\t\t\t&#xfeff;\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div id=\"${idLoader}\">\n\t\t\t\t\t\t\t\t\t<div class=\"spin-wrapper\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"spinner\">\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div id=\"${idFooter}\">\n\t\t\t\t\t\t\t\t<button id=\"${idButtonBook}\" class=\"pure-material-button-contained\">Book</button>\n\t\t\t\t\t\t\t\t<button id=\"${idButtonClear}\" class=\"pure-material-button-outlined\">Clear</button>\n\t\t\t\t\t\t\t\t<button id=\"${idButtonClose}\" class=\"pure-material-button-outlined\">Close</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`;\n    document.body.appendChild(dummy.querySelector('div'));\n\n    setTimeout(() => {\n      // must be deferred, https://stackoverflow.com/questions/18509507/why-use-settimeout-in-deferred\n      document.getElementById(idInput).focus();\n    }, 0);\n\n    // document.getElementById(idInput).addEventListener('paste', (e) => { // https://stackoverflow.com/questions/21257688/paste-rich-text-into-content-editable-div-and-only-keep-bold-and-italics-formatt\n    // \te.preventDefault();\n    // \tconst clipboardData = e.clipboardData;\n    // \tconst dataText = clipboardData.getData('text/plain');\n    // \tif (dataText && dataText.trim().length != 0) {\n    // \t\tdocument.getElementById(idInput).innerText = dataText;\n    // \t\treturn false; // prevent returning text in clipboard\n    // \t}\n    // }, false);\n    //\n    // ...this is good, but the following is better...\n    //\n    document.getElementById(idInput).addEventListener('paste', (e) => {\n      // https://stackoverflow.com/questions/12027137/javascript-trick-for-paste-as-plain-text-in-execcommand/19327995#19327995\n      e.preventDefault();\n      const content = ((e as any).originalEvent || e).clipboardData.getData(\n        'text/plain',\n      );\n      document.execCommand('insertText', false, content);\n    });\n\n    document.getElementById(idButtonBook).onclick = () => {\n      const input = document.getElementById(idInput);\n\n      // remove all html except line breaks\n      input.querySelectorAll('span').forEach((span) => {\n        // also: ... .forEach(span => { ...\n        input.removeChild(span);\n      });\n\n      const string = input.innerText; // or https://developer.mozilla.org/de/docs/Web/API/Node/textContent but textContent ignores line breaks\n      if (string.trim().length === 0) {\n        return;\n      }\n\n      function setEnabled(isEnabled) {\n        [idButtonBook, idButtonClear, idButtonClose].forEach((id) => {\n          (document.getElementById(id) as any).disabled = !isEnabled;\n        });\n        input.contentEditable = isEnabled;\n        input.focus();\n        document.getElementById(idLoader).style.visibility = isEnabled\n          ? 'hidden'\n          : 'visible';\n      }\n      setEnabled(false);\n\n      const selectType = document.getElementById(idSelectType);\n      const timesheetTypeUuid = (selectType as any).options[\n        (selectType as any).selectedIndex\n      ].value;\n\n      input.innerHTML = '';\n      let linePrevious;\n\n      const lineArray = string.split(/\\r\\n|\\r|\\n/g); // also string.split(/\\r?\\n/g); but mind: https://stackoverflow.com/questions/21711768/split-string-in-javascript-and-detect-line-break/21712066#21712066\n      // lineArray.forEach((line) => { ...\n      // the whole booking process has to be done sequential via synchronous xhr (xhr is parallel/async by default),\n      // so caches can work, AND most importantly no duplicate entities are created\n      // but synchronous xhr should be used in workers exclusively: https://xhr.spec.whatwg.org/#synchronous-flag\n      // ...thus forEach cannot be used\n      //\n      // \"Synchronous XMLHttpRequest outside of workers is in the process of being removed from the web platform\n      // as it has detrimental effects to the end user’s experience. (This is a long process that takes many years.)\n      // Developers must not pass false for the async argument when current global object is a Window object.\n      // User agents are strongly encouraged to warn about such usage in developer tools\n      // and may experiment with throwing an \"InvalidAccessError\" DOMException when it occurs.\"\n      //\n      // ...thus let's simulate synchronours xhr with a mutex callback... https://www.mkyong.com/java/java-thread-mutex-and-semaphore-example/\n      const synchronizedLineProcessor = (\n        statusOfPreviousLine?: string,\n      ): void => {\n        if (linePrevious) {\n          input.innerHTML =\n            (input.innerHTML ? input.innerHTML + '<br>' : '') +\n            (statusOfPreviousLine\n              ? '<span class=\"pill\" style=\"background-color: ' +\n                (statusOfPreviousLine === statusOfPreviousLineDone\n                  ? 'green'\n                  : 'red') +\n                ';\">' +\n                statusOfPreviousLine +\n                '</span>'\n              : '') +\n            linePrevious;\n          input.scrollTop = input.scrollHeight; // https://stackoverflow.com/questions/40495860/how-to-scroll-to-automatically-scroll-to-the-bottom-of-an-editable-div-onload/40506676#40506676\n        }\n        if (lineArray.length > 0) {\n          linePrevious = lineArray.shift(); // https://love2dev.com/blog/javascript-remove-from-array/\n          checkLineAndParseProperties(\n            linePrevious,\n            timesheetTypeUuid,\n            synchronizedLineProcessor,\n          ); // first step, forwards to consecutive steps\n        } else {\n          setEnabled(true);\n          const refreshButton = document.querySelector(\n            'button[ng-click=\"refresh()\"]',\n          );\n          if (refreshButton) {\n            (refreshButton as any).click();\n          }\n        }\n      };\n      setTimeout(() => {\n        // must be deferred\n        synchronizedLineProcessor();\n      }, 0);\n    };\n\n    document.getElementById(idButtonClear).onclick = () => {\n      // https://stackoverflow.com/questions/6348494/addeventlistener-vs-onclick\n      const input = document.getElementById(idInput);\n      input.innerHTML = ''; // https://stackoverflow.com/questions/3450593/how-do-i-clear-the-content-of-a-div-using-javascript\n      input.focus();\n    };\n\n    document.getElementById(idButtonClose).onclick = () => {\n      clear();\n    };\n\n    document.onkeydown = (event: any) => {\n      event = event || window.event;\n      if (event.keyCode == 27) {\n        // ESC key\n        clear();\n        document.onkeydown = undefined; // deregister\n      }\n    };\n\n    window['COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING'] = false;\n  });\n}\n\nfunction checkLineAndParseProperties(\n  line: string,\n  timesheetTypeUuid: string,\n  callback: (statusOfPreviousLine?: string) => void,\n) {\n  line = line.trim();\n  if (!line) {\n    callback(); // no error on empty line\n    return;\n  }\n\n  function computeProperties(\n    line: string,\n  ): TimecockpitEntryProperties | undefined {\n    // basic sanity checks:\n    // 2019-03-11|12:00|16:00|...|...\n    // 0123456789 123456789 123456789\n    if (\n      line.length <= 23 || // first 23 characters are fixed width: date, time, time\n      isNaN(+line.charAt(0)) || // first character must be a number: https://stackoverflow.com/questions/8935632/check-if-character-is-number\n      '|' !== line.charAt(10) ||\n      '|' !== line.charAt(16) ||\n      '|' !== line.charAt(22)\n    ) {\n      return;\n    }\n\n    // date and times\n    const stringDate = line.substr(0, 10); // https://www.w3schools.com/jsref/jsref_obj_string.asp\n    const stringTimeBegin = line.substr(11, 5);\n    const stringTimeEnd = line.substr(17, 5);\n    // Jira key\n    const indexOfPipe = line.indexOf('|', 23);\n    if (indexOfPipe === -1) {\n      // no delimiter after Jira key\n      return;\n    }\n    const stringJiraKey = line.substring(23, indexOfPipe); // https://stackoverflow.com/questions/2243824/what-is-the-difference-between-string-slice-and-string-substring\n    if (stringJiraKey === '') {\n      return;\n    }\n    // comment\n    const stringComment = line.substr(indexOfPipe + 1);\n    if (stringComment === '') {\n      // empty comment\n      return;\n    }\n\n    // ---\n\n    // date sanity checks\n    // valid delimiters\n    if ('-' !== stringDate.charAt(4) || '-' !== stringDate.charAt(7)) {\n      return;\n    }\n    // valid digits: https://stackoverflow.com/questions/175739/built-in-way-in-javascript-to-check-if-a-string-is-a-valid-number\n    if (\n      isNaN(+stringDate.charAt(0)) ||\n      isNaN(+stringDate.charAt(1)) ||\n      isNaN(+stringDate.charAt(2)) ||\n      isNaN(+stringDate.charAt(3)) ||\n      isNaN(+stringDate.charAt(5)) ||\n      isNaN(+stringDate.charAt(6)) ||\n      isNaN(+stringDate.charAt(8)) ||\n      isNaN(+stringDate.charAt(9))\n    ) {\n      return;\n    }\n    // valid year\n    const integerYearCurrent = new Date().getFullYear();\n    const integerYear = parseInt(stringDate.substr(0, 4), 10);\n    // if (isNaN(integerYear) || integerYear < 2019 || integerYear > 2046) {\n    if (\n      isNaN(integerYear) ||\n      integerYear < integerYearCurrent ||\n      integerYear > integerYearCurrent\n    ) {\n      return;\n    }\n    // valid month\n    const integerMonth = parseInt(stringDate.substr(5, 2), 10);\n    if (isNaN(integerYear) || integerMonth < 1 || integerMonth > 12) {\n      return;\n    }\n    // valid day\n    const integerDay = parseInt(stringDate.substr(8, 2), 10);\n    if (isNaN(integerYear) || integerDay < 1 || integerDay > 31) {\n      return;\n    }\n    // valid date\n    if (\n      (() => {\n        const date = new Date();\n        date.setFullYear(integerYear, integerMonth - 1, integerDay);\n        return (\n          date.getFullYear() !== integerYear ||\n          date.getMonth() !== integerMonth - 1 ||\n          date.getDate() !== integerDay\n        ); // https://ctrlq.org/code/20109-javascript-date-valid\n      })()\n    ) {\n      return;\n    }\n\n    // ---\n\n    // valid delimiters\n    if (':' !== stringTimeBegin.charAt(2) || ':' !== stringTimeEnd.charAt(2)) {\n      return;\n    }\n    // valid digits\n    if (isInvalidDigit(stringTimeBegin) || isInvalidDigit(stringTimeEnd)) {\n      return;\n    }\n    // valid hours\n    const integerHourBegin = parseInt(stringTimeBegin.substr(0, 2), 10);\n    const integerHourEnd = parseInt(stringTimeEnd.substr(0, 2), 10);\n    if (isInvalidHour(integerHourBegin) || isInvalidHour(integerHourEnd)) {\n      return;\n    }\n    // valid minutes\n    const integerMinuteBegin = parseInt(stringTimeBegin.substr(3, 2), 10);\n    const integerMinuteEnd = parseInt(stringTimeEnd.substr(3, 2), 10);\n    if (\n      isInvalidMinute(integerMinuteBegin) ||\n      isInvalidMinute(integerMinuteEnd)\n    ) {\n      return;\n    }\n    // begin actually before end\n    if (\n      integerHourBegin > integerHourEnd ||\n      (integerHourBegin === integerHourEnd &&\n        integerMinuteBegin >= integerMinuteEnd)\n    ) {\n      return;\n    }\n\n    // ---\n\n    const APP_BeginTime = stringDate + 'T' + stringTimeBegin + ':00';\n    const APP_EndTime = stringDate + 'T' + stringTimeEnd + ':00';\n    // const APP_Description = encodeURIComponent(stringComment); // encoding not necessary, https://stackoverflow.com/questions/332872/encode-url-in-javascript/6171234#6171234\n    const APP_Description = stringComment;\n\n    return {\n      // https://stackoverflow.com/questions/12272239/javascript-function-returning-an-object\n      jiraKey: stringJiraKey,\n      APP_BeginTime: APP_BeginTime,\n      APP_EndTime: APP_EndTime,\n      APP_Description: APP_Description,\n    };\n  }\n\n  const properties = computeProperties(line);\n\n  if (properties !== undefined) {\n    properties.USR_TimesheetTypeUuid = timesheetTypeUuid;\n    queryUserId(properties, callback);\n  } else {\n    callback('invalid');\n  }\n}\n\nfunction queryUserId(\n  properties: TimecockpitEntryProperties,\n  callback: (statusOfPreviousLine?: string) => void,\n) {\n  function nextStep() {\n    properties.APP_UserDetailUuid = cacheUserDetailUuid;\n    checkIfEntityWithEqualBeginOrEndTimeAlreadyExists(properties, callback);\n  }\n\n  if (cacheUserDetailUuid) {\n    nextStep(); // not deferred, because async xhr starts immediately in next step\n    return; // avoid running callback too early\n  }\n\n  xhrGet('/shell/user')\n    .then((response: string) => {\n      const json = JSON.parse(response);\n\n      if (json) {\n        if (json.useruuid) {\n          cacheUserDetailUuid = json.useruuid;\n          nextStep();\n          return; // avoid running callback too early\n        } else {\n          console.log('ERROR: no useruuid available');\n        }\n      } else {\n        console.log('ERROR: on JSON.parse() in queryUserId()');\n      }\n      callback('error');\n    })\n    .catch((error) => {\n      console.log('ERROR: in queryUserId()', error);\n      callback(error.status || 'error');\n    });\n}\n\nfunction checkIfEntityWithEqualBeginOrEndTimeAlreadyExists(\n  properties: TimecockpitEntryProperties,\n  callback: (statusOfPreviousLine?: string) => void,\n) {\n  xhrGet(\n    `/odata/APP_Timesheet?$filter=(APP_BeginTime eq datetime'${properties.APP_BeginTime}' or APP_EndTime eq datetime'${properties.APP_EndTime}') and APP_UserDetailUuid eq guid'${properties.APP_UserDetailUuid}'`,\n  )\n    .then((response) => {\n      const json = JSON.parse(response);\n\n      if (json && json.value) {\n        if (json.value.length > 0) {\n          console.log(\n            'ERROR: APP_Timesheet entity with equal start- (' +\n              properties.APP_BeginTime +\n              ') and/or end-time (' +\n              properties.APP_EndTime +\n              ') exists',\n          );\n          callback('exists');\n          return;\n        } else {\n          queryTaskIdAndProjectIdForJiraKey(properties, callback);\n          return; // avoid running callback too early\n        }\n      } else {\n        console.log(\n          'ERROR: on JSON.parse() in checkIfEntityWithEqualBeginOrEndTimeAlreadyExists()',\n        );\n      }\n      callback('error');\n    })\n    .catch((error) => {\n      console.log(\n        'ERROR: in checkIfEntityWithEqualBeginOrEndTimeAlreadyExists()',\n        error,\n      );\n      callback(error.status || 'error');\n    });\n}\n\nfunction queryTaskIdAndProjectIdForJiraKey(\n  properties: TimecockpitEntryProperties,\n  callback: (statusOfPreviousLine?: string) => void,\n) {\n  function nextStep() {\n    const cache = cacheTaskIdAndProjectId.get(properties.jiraKey);\n    properties.APP_TaskUuid = cache.APP_TaskUuid;\n    properties.APP_ProjectUuid = cache.APP_ProjectUuid;\n\n    createEntity(properties, callback);\n  }\n  if (cacheTaskIdAndProjectId.has(properties.jiraKey)) {\n    nextStep(); // not deferred, because async xhr starts immediately in next step\n    return; // avoid running callback too early\n  }\n  xhrGet(\n    `/odata/APP_Task?$filter=APP_Code eq '${properties.jiraKey}'&$select=APP_TaskUuid,APP_ProjectUuid`,\n  )\n    .then((response) => {\n      const json = JSON.parse(response); // https://stackoverflow.com/questions/33169315/json-parse-selecting-from-a-select-container\n      if (json && json.value) {\n        if (json.value.length > 0) {\n          cacheTaskIdAndProjectId.set(properties.jiraKey, {\n            APP_TaskUuid: json.value[0].APP_TaskUuid,\n            APP_ProjectUuid: json.value[0].APP_ProjectUuid,\n          });\n          nextStep();\n          return; // avoid running callback too early\n        } else {\n          console.log(\n            'ERROR: no APP_Task entity for specified Jira key (' +\n              properties.jiraKey +\n              ') available',\n          );\n        }\n      } else {\n        console.log(\n          'ERROR: on JSON.parse() in queryTaskIdAndProjectIdForJiraKey()',\n        );\n      }\n      callback('error');\n    })\n    .catch((error) => {\n      console.log('ERROR: in queryTaskIdAndProjectIdForJiraKey()', error);\n      callback(error.status || 'error');\n    });\n}\n\nfunction createEntity(\n  properties: TimecockpitEntryProperties,\n  callback: (statusOfPreviousLine?: string) => void,\n) {\n  const json = JSON.stringify({\n    // 'APP_TimesheetUuid': https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript/2117523#2117523\n    APP_BeginTime: properties.APP_BeginTime,\n    APP_EndTime: properties.APP_EndTime,\n    APP_Description: properties.APP_Description,\n    APP_TaskUuid: properties.APP_TaskUuid,\n    APP_ProjectUuid: properties.APP_ProjectUuid,\n    APP_UserDetailUuid: properties.APP_UserDetailUuid,\n    USR_TimesheetTypeUuid: properties.USR_TimesheetTypeUuid,\n    // 'APP_IsDurationTimesheet': false,\n    // 'APP_NoBilling': false,\n    // 'USR_MedicalConfirmationReceived': false\n  });\n\n  xhrPost('/odata/APP_Timesheet', json)\n    .then(() => {\n      callback(statusOfPreviousLineDone);\n    })\n    .catch((error) => {\n      console.log('ERROR: in createEntity()', error);\n      callback(error.status || 'error');\n    });\n}\n\nfunction deleteEntity(APP_TimesheetUuid) {\n  xhrDelete(`/odata/APP_Timesheet(guid'${APP_TimesheetUuid}')`)\n    .then(() => {\n      console.log(\n        'deleted APP_Timesheet entity with UUID: ' + APP_TimesheetUuid,\n      );\n    })\n    .catch((error) => {\n      console.log('ERROR: in deleteEntity()', error);\n    });\n}\n\nasync function xhrGet(url: string): Promise<string> {\n  return xhr(url);\n}\n\nasync function xhrPost(url: string, json?: any): Promise<string> {\n  return xhr(url, 'POST', json);\n}\n\nasync function xhrDelete(url: string): Promise<string> {\n  return xhr(url, 'DELETE');\n}\n\nasync function xhr(url: string, method?: string, json?: any): Promise<string> {\n  const request = new XMLHttpRequest();\n\n  return new Promise((resolve, reject) => {\n    request.onreadystatechange = () => {\n      if (request.readyState !== 4) return; // 4 is DONE, https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\n      if (request.status >= 200 && request.status < 300) {\n        resolve(request.responseText);\n      } else {\n        reject({\n          status: request.status,\n          statusText: request.statusText,\n        });\n      }\n    };\n    request.open(method || 'GET', url, true);\n    request.setRequestHeader('cache-control', 'no-cache'); // https://stackoverflow.com/a/48969579\n    request.setRequestHeader('cache-control', 'max-age=0');\n    request.setRequestHeader('pragma', 'no-cache');\n    if (method === 'POST') {\n      // if (json) {\n      request.setRequestHeader(\n        'Content-Type',\n        'application/json; charset=utf-8',\n      );\n      request.send(json);\n    } else {\n      request.send();\n    }\n  });\n}\n\n// RUN BOOKMARKLET\n(() => {\n  // console.clear();\n\n  if (window['COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING']) {\n    console.log('ERROR: bookmarklet is already running');\n    return; // https://stackoverflow.com/questions/550574/how-to-terminate-the-script-in-javascript\n  }\n  window['COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING'] = true; // global scope var, https://stackoverflow.com/questions/9521298/verify-external-script-is-loaded\n\n  console.log('bookmarklet called');\n\n  const url = 'https://dynatrace.timecockpit.com';\n\n  if (window.location.origin !== url) {\n    const dummy = document.createElement('dummy');\n    dummy.innerHTML = `\n\t\t\t<div style=\"position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: 999; background-color: rgba(0, 0, 0, 0.66); display: grid;\">\n\t\t\t\t<div style=\"margin: auto; padding: 24px; box-sizing: border-box; font-size: 24px; background-color: yellow; border-radius: 4px; font-family: Roboto, 'Segoe UI', BlinkMacSystemFont, system-ui, -apple-system, Arial, Helvetica, sans-serif;\">\n\t\t\t\t\t...redirecting to ' + url + '. Run the bookmarklet again after the site loaded.\n\t\t\t\t</div>\n\t\t\t</div>`;\n    document.body.appendChild(dummy.querySelector('div')); // https://developer.mozilla.org/de/docs/Web/API/Document/body and https://stackoverflow.com/questions/9614932/best-way-to-create-large-static-dom-elements-in-javascript\n\n    window.setTimeout(() => {\n      // https://stackoverflow.com/questions/18048338/how-can-i-execute-a-script-after-calling-window-location-href\n      // window.onload = () => { ... cannot be performed after the redirect\n      window.location.href = url;\n    }, 1000);\n  } else if (document.readyState && document.readyState === 'complete') {\n    createContent();\n  } else {\n    window['COM_KAMILSARELO_DYNATRACE_TIMETRACKING_FORK_RUNNING'] = false;\n  }\n})();\n"],"sourceRoot":""}